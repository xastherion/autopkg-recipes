<?xml version="1.0" ?>
<recipe>
    <identifier>com.github.rustdesk.munki</identifier>
    <description>Downloads the latest RustDesk application and imports it into Munki.</description>
    <minimum_version>0.5.0</minimum_version>
    <input>
        <KEY>NAME</KEY>
        <VALUE>RustDesk</VALUE>
        <KEY>GITHUB_REPO</KEY>
        <VALUE>rustdesk/rustdesk</VALUE>
        <KEY>MUNKI_REPO_SUBDIR</KEY>
        <VALUE>apps/RustDesk</VALUE>
    </input>
    <process>
        <dict>
            <key>Processor</key>
            <string>GitHubReleasesInfoProvider</string>
            <key>Arguments</key>
            <dict>
                <key>github_repo</key>
                <string>%GITHUB_REPO%</string>
                <key>include_prereleases</key>
                <false/>
            </dict>
        </dict>
        <dict>
            <key>Processor</key>
            <string>URLDownloader</string>
            <key>Arguments</key>
            <dict>
                <key>url</key>
                <string>%release_download_url%</string>
                <key>filename</key>
                <string>%NAME%.dmg</string>
            </dict>
        </dict>
        <dict>
            <key>Processor</key>
            <string>DmgCreator</string>
            <key>Arguments</key>
            <dict>
                <key>dmg_path</key>
                <string>%pathname%</string>
            </dict>
        </dict>
        <dict>
            <key>Processor</key>
            <string>MunkiImporter</string>
            <key>Arguments</key>
            <dict>
                <key>dmg_path</key>
                <string>%pathname%</string>
                <key>pkginfo</key>
                <dict>
                    <key>name</key>
                    <string>%NAME%</string>
                    <key>display_name</key>
                    <string>RustDesk</string>
                    <key>version</key>
                    <string>%version%</string>
                </dict>
                <key>repo_subdirectory</key>
                <string>%MUNKI_REPO_SUBDIR%</string>
            </dict>
        </dict>
    </process>
</recipe>

